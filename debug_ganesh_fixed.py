#!/usr/bin/env python3
"""
Test the Ganesh Chaturthi text that was producing ugly truncations
"""

from proper_slm_summarizer import StateOfTheArtIndicSummarizer

def test_ganesh_issue():
    """Test with the specific Ganesh Chaturthi text that was being truncated badly"""
    
    ganesh_text = """‡∞ó‡∞£‡±á‡∞∂‡±ç ‡∞ö‡∞§‡±Å‡∞∞‡±ç‡∞•‡∞ø ‡∞Ö‡∞®‡±á‡∞¶‡∞ø ‡∞π‡∞ø‡∞Ç‡∞¶‡±Ç ‡∞Æ‡∞§‡∞Ç‡∞≤‡±ã ‡∞Ö‡∞§‡±ç‡∞Ø‡∞Ç‡∞§ ‡∞™‡±ç‡∞∞‡∞æ‡∞Æ‡±Å‡∞ñ‡±ç‡∞Ø‡∞§ ‡∞ï‡∞≤‡∞ø‡∞ó‡∞ø‡∞® ‡∞™‡∞Ç‡∞°‡±Å‡∞ó‡∞≤‡∞≤‡±ã ‡∞í‡∞ï‡∞ü‡∞ø. ‡∞à ‡∞™‡∞Ç‡∞°‡±Å‡∞ó‡∞®‡±Å ‡∞≠‡∞ó‡∞µ‡∞Ç‡∞§‡±Å‡∞°‡±Å ‡∞µ‡∞ø‡∞®‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡∞ø ‡∞ú‡∞®‡±ç‡∞Æ‡∞¶‡∞ø‡∞®‡∞Ç‡∞ó‡∞æ ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞∏‡∞Ç‡∞µ‡∞§‡±ç‡∞∏‡∞∞‡∞Ç ‡∞≠‡∞æ‡∞¶‡±ç‡∞∞‡∞™‡∞¶ ‡∞∂‡±Å‡∞¶‡±ç‡∞ß ‡∞ö‡∞§‡±Å‡∞∞‡±ç‡∞•‡∞ø ‡∞®‡∞æ‡∞°‡±Å ‡∞ò‡∞®‡∞Ç‡∞ó‡∞æ ‡∞ú‡∞∞‡±Å‡∞™‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡∞æ‡∞∞‡±Å. ‡∞ó‡∞£‡∞™‡∞§‡∞ø ‡∞¶‡±á‡∞µ‡±Å‡∞°‡±Å ‡∞µ‡∞ø‡∞ú‡±ç‡∞û‡∞æ‡∞®‡∞æ‡∞®‡∞ø‡∞ï‡∞ø, ‡∞µ‡∞ø‡∞ú‡∞Ø‡∞æ‡∞®‡∞ø‡∞ï‡∞ø, ‡∞Ü‡∞ü‡∞Ç‡∞ï‡∞æ‡∞≤ ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£‡∞ï‡±Å ‡∞™‡±ç‡∞∞‡∞§‡±Ä‡∞ï‡∞ó‡∞æ ‡∞™‡±Ç‡∞ú‡∞ø‡∞Ç‡∞ö‡∞¨‡∞°‡∞§‡∞æ‡∞°‡±Å. ‡∞à ‡∞™‡∞Ç‡∞°‡±Å‡∞ó ‡∞∞‡±ã‡∞ú‡±Å‡∞® ‡∞á‡∞Ç‡∞ü‡∞ø‡∞≤‡±ç‡∞≤‡∞ø‡∞™‡∞æ‡∞¶‡±Ä ‡∞ó‡∞£‡∞™‡∞§‡∞ø ‡∞µ‡∞ø‡∞ó‡±ç‡∞∞‡∞π‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞∏‡±ç‡∞•‡∞æ‡∞™‡∞ø‡∞Ç‡∞ö‡∞ø, ‡∞™‡±Å‡∞∑‡±ç‡∞™‡∞æ‡∞≤‡±Å, ‡∞™‡∞≥‡±ç‡∞≥‡±Å, ‡∞Æ‡±ã‡∞¶‡∞ï‡∞æ‡∞≤‡±Å (‡∞ï‡±Å‡∞¶‡±Å‡∞∞‡±Å ‡∞≤‡∞°‡±ç‡∞°‡±Ç‡∞≤‡±Å) ‡∞µ‡∞Ç‡∞ü‡∞ø ‡∞®‡±à‡∞µ‡±á‡∞¶‡±ç‡∞Ø‡∞æ‡∞≤‡∞§‡±ã ‡∞ó‡∞£‡±á‡∞∂‡±Å‡∞°‡∞ø‡∞®‡∞ø ‡∞≠‡∞ï‡±ç‡∞§‡∞ø‡∞§‡±ã ‡∞™‡±Ç‡∞ú‡∞ø‡∞∏‡±ç‡∞§‡∞æ‡∞∞‡±Å. ‡∞¶‡±á‡∞∂‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡±ç‡∞§‡∞Ç‡∞ó‡∞æ, ‡∞Æ‡±Å‡∞ñ‡±ç‡∞Ø‡∞Ç‡∞ó‡∞æ ‡∞Æ‡∞π‡∞æ‡∞∞‡∞æ‡∞∑‡±ç‡∞ü‡±ç‡∞∞, ‡∞Ü‡∞Ç‡∞ß‡±ç‡∞∞‡∞™‡±ç‡∞∞‡∞¶‡±á‡∞∂‡±ç, ‡∞§‡±Ü‡∞≤‡∞Ç‡∞ó‡∞æ‡∞£, ‡∞§‡∞Æ‡∞ø‡∞≥‡∞®‡∞æ‡∞°‡±Å, ‡∞ï‡∞∞‡±ç‡∞£‡∞æ‡∞ü‡∞ï ‡∞µ‡∞Ç‡∞ü‡∞ø ‡∞∞‡∞æ‡∞∑‡±ç‡∞ü‡±ç‡∞∞‡∞æ‡∞≤‡∞≤‡±ã ‡∞à ‡∞™‡∞Ç‡∞°‡±Å‡∞ó‡∞®‡±Å ‡∞Ö‡∞§‡±ç‡∞Ø‡∞Ç‡∞§ ‡∞â‡∞§‡±ç‡∞∏‡∞æ‡∞π‡∞Ç‡∞ó‡∞æ ‡∞ú‡∞∞‡±Å‡∞™‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡∞æ‡∞∞‡±Å. ‡∞™‡±Ü‡∞¶‡±ç‡∞¶ ‡∞™‡±Ü‡∞¶‡±ç‡∞¶ ‡∞™‡∞Ç‡∞°‡±Å‡∞ó ‡∞Æ‡∞Ç‡∞°‡∞™‡∞æ‡∞≤‡∞≤‡±ã ‡∞≠‡∞æ‡∞∞‡±Ä ‡∞µ‡∞ø‡∞ó‡±ç‡∞∞‡∞π‡∞æ‡∞≤‡∞®‡±Å ‡∞™‡±ç‡∞∞‡∞§‡∞ø‡∞∑‡±ç‡∞ü‡∞ø‡∞Ç‡∞ö‡∞ø, ‡∞™‡∞≤‡±Å ‡∞∞‡±ã‡∞ú‡±Å‡∞≤ ‡∞™‡∞æ‡∞ü‡±Å ‡∞®‡±É‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡±Å, ‡∞∏‡∞Ç‡∞ó‡±Ä‡∞§ ‡∞ï‡∞æ‡∞∞‡±ç‡∞Ø‡∞ï‡±ç‡∞∞‡∞Æ‡∞æ‡∞≤‡±Å, ‡∞™‡±Ç‡∞ú‡∞≤‡±Å ‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞π‡∞ø‡∞∏‡±ç‡∞§‡∞æ‡∞∞‡±Å. ‡∞ö‡∞ø‡∞µ‡∞∞‡∞ó‡∞æ, ‡∞µ‡∞ø‡∞®‡∞æ‡∞Ø‡∞ï ‡∞®‡∞ø‡∞Æ‡∞ú‡±ç‡∞ú‡∞®‡∞Ç‡∞§‡±ã ‡∞à ‡∞™‡∞Ç‡∞°‡±Å‡∞ó ‡∞Æ‡±Å‡∞ó‡±Å‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞á‡∞¶‡∞ø ‡∞∏‡∞æ‡∞Æ‡±Ç‡∞π‡∞ø‡∞ï ‡∞≠‡∞ï‡±ç‡∞§‡∞ø, ‡∞∏‡∞æ‡∞Ç‡∞∏‡±ç‡∞ï‡±É‡∞§‡∞ø‡∞ï ‡∞ê‡∞ï‡±ç‡∞Ø‡∞§‡∞®‡±Å ‡∞™‡±ç‡∞∞‡∞§‡∞ø‡∞¨‡∞ø‡∞Ç‡∞¨‡∞ø‡∞Ç‡∞ö‡±á ‡∞™‡∞Ç‡∞°‡±Å‡∞ó‡∞ó‡∞æ ‡∞Æ‡∞æ‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø. ‡∞ó‡∞£‡±á‡∞∂‡±ç ‡∞ö‡∞§‡±Å‡∞∞‡±ç‡∞•‡∞ø ‡∞™‡∞Ç‡∞°‡±Å‡∞ó ‡∞∏‡∞Æ‡∞Ø‡∞Ç‡∞≤‡±ã ‡∞™‡∞∞‡±ç‡∞Ø‡∞æ‡∞µ‡∞∞‡∞£‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞¶‡±É‡∞∑‡±ç‡∞ü‡∞ø‡∞≤‡±ã ‡∞â‡∞Ç‡∞ö‡±Å‡∞ï‡±Å‡∞®‡∞ø ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞µ‡∞ø‡∞ó‡±ç‡∞∞‡∞π‡∞æ‡∞≤‡∞®‡±Å ‡∞™‡±ç‡∞∞‡±ã‡∞§‡±ç‡∞∏‡∞π‡∞ø‡∞Ç‡∞ö‡∞°‡∞Ç, ‡∞™‡∞ö‡±ç‡∞ö‡∞¶‡∞®‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞ï‡∞æ‡∞™‡∞æ‡∞°‡∞ü‡∞Ç ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞ï‡±Ç‡∞°‡∞æ ‡∞™‡±ç‡∞∞‡∞ú‡∞≤‡±ç‡∞≤‡±ã ‡∞ö‡±à‡∞§‡∞®‡±ç‡∞Ø‡∞Ç ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞§‡±ã‡∞Ç‡∞¶‡∞ø."""
    
    print("üß™ Testing Ganesh Chaturthi text that was getting truncated badly")
    print("=" * 70)
    print(f"Original text length: {len(ganesh_text)} characters")
    print()
    
    try:
        summarizer = StateOfTheArtIndicSummarizer()
        summary, method = summarizer.summarize(ganesh_text, max_length=300)
        
        print(f"üìù Generated Summary ({method}):")
        print(f"   {summary}")
        print()
        print(f"Summary length: {len(summary)} characters")
        
        # Check for ugly truncations - these should NOT be in the summary
        ugly_patterns = ["‡∞™‡∞ö‡±ç‡∞ö‡∞¶", "‡∞Æ‡±Å                       ‡±Å‡∞ó‡±Å‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø", "‡∞™‡±ç‡∞∞‡∞¶‡±á‡∞∂‡±ç                              "]
        
        has_ugly_truncation = any(pattern in summary for pattern in ugly_patterns)
        
        if has_ugly_truncation:
            print("‚ùå STILL HAS UGLY TRUNCATIONS!")
            for pattern in ugly_patterns:
                if pattern in summary:
                    print(f"   Found: '{pattern}'")
        else:
            print("‚úÖ NO UGLY TRUNCATIONS! Summary looks clean.")
        
        # Check if summary ends properly
        if summary.endswith('.') or summary.endswith('‡•§'):
            print("‚úÖ Summary ends with proper punctuation")
        else:
            print(f"‚ö†Ô∏è  Summary ends with: '{summary[-10:]}'")
        
        # Check if it's not just a copy
        if not ganesh_text.startswith(summary.replace("...", "").strip()):
            print("‚úÖ Summary is not just a truncated copy")
        else:
            print("‚ùå Summary is still just a truncated copy")
            
        return summary, method
        
    except Exception as e:
        print(f"‚ùå Error: {e}")
        return None, None

if __name__ == "__main__":
    test_ganesh_issue()
